<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="数学高斯消元 O(n^3)12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970#include &lt;bits&#x2F;stdc++.h&gt;using namespace std;const">
<meta property="og:type" content="article">
<meta property="og:title" content="竞赛模板整理">
<meta property="og:url" content="https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/index.html">
<meta property="og:site_name" content="LuoZui&#96; Blog">
<meta property="og:description" content="数学高斯消元 O(n^3)12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970#include &lt;bits&#x2F;stdc++.h&gt;using namespace std;const">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2018-10-16T14:06:38.000Z">
<meta property="article:modified_time" content="2020-12-02T16:24:16.644Z">
<meta property="article:author" content="LuoZui">
<meta property="article:tag" content="模板">
<meta name="twitter:card" content="summary">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>竞赛模板整理</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.2.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body class="max-width mx-auto px3 ltr">    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">简介</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="//github.com/luozui">项目</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/12/15/pass/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/02/01/MLWEEK123/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&text=竞赛模板整理"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&title=竞赛模板整理"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&is_video=false&description=竞赛模板整理"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=竞赛模板整理&body=Check out this article: https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&title=竞赛模板整理"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&title=竞赛模板整理"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&title=竞赛模板整理"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&title=竞赛模板整理"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&name=竞赛模板整理&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">数学</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.1.</span> <span class="toc-text">高斯消元 O(n^3)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.2.</span> <span class="toc-text">等价矩阵 O(n^3)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.3.</span> <span class="toc-text">行列式的值 O(n^3)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.4.</span> <span class="toc-text">离散数对</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.5.</span> <span class="toc-text">格雷码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.6.</span> <span class="toc-text">求阶乘 $O(p \log_p n).$</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.7.</span> <span class="toc-text">原根</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.8.</span> <span class="toc-text">卡特兰数应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.9.</span> <span class="toc-text">康托展开（求任意排列的排名）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.0.9.1.</span> <span class="toc-text">什么是排列的排名？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.0.9.2.</span> <span class="toc-text">时间复杂度？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.0.9.3.</span> <span class="toc-text">怎么实现？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.0.9.4.</span> <span class="toc-text">举个栗子</span></a></li><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.0.9.5.</span> <span class="toc-text">逆康托展开</span></a></li><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.0.9.6.</span> <span class="toc-text">引用上面展开的例子</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.10.</span> <span class="toc-text">约瑟夫</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.11.</span> <span class="toc-text">Stirling 数（子集划分）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.12.</span> <span class="toc-text">整数拆分</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">博弈</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">2.0.1.</span> <span class="toc-text">任意图表上的博弈</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">2.0.2.</span> <span class="toc-text">FFT</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">计算几何</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">3.0.1.</span> <span class="toc-text">O(N) 求简单多边形面积</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">3.0.2.</span> <span class="toc-text">凸多边形内接圆</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">3.0.3.</span> <span class="toc-text">通过“缩小边”的方法在凸多边形中找到内切圆 O（n  log n）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">3.0.4.</span> <span class="toc-text">找到三角形联合的区域。垂直分解法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">3.0.4.1.</span> <span class="toc-text">决定</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">3.0.5.</span> <span class="toc-text">半平面交</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">4.0.1.</span> <span class="toc-text">笛卡尔树</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">4.0.2.</span> <span class="toc-text">解析表达式</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        竞赛模板整理
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">LuoZui` Blog</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2018-10-16T14:06:38.000Z" itemprop="datePublished">2018-10-16</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/%E6%A8%A1%E6%9D%BF/" rel="tag">模板</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2><span id="数学">数学</span></h2><h4><span id="高斯消元-on3">高斯消元 O(n^3)</span></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> EPS = <span class="number">1e-9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gauss</span> <span class="params">(<span class="built_in">vector</span> &lt; <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; &gt; a, <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; &amp; ans)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = (<span class="keyword">int</span>) a.size();</span><br><span class="line">    <span class="keyword">int</span> m = (<span class="keyword">int</span>) a[<span class="number">0</span>].size() - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">where</span> <span class="params">(m, <span class="number">-1</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> col=<span class="number">0</span>, row=<span class="number">0</span>; col&lt;m &amp;&amp; row&lt;n; ++col) &#123;</span><br><span class="line">        <span class="keyword">int</span> sel = row;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=row; i&lt;n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">abs</span> (a[i][col]) &gt; <span class="built_in">abs</span> (a[sel][col]))</span><br><span class="line">                sel = i;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">abs</span> (a[sel][col]) &lt; EPS)</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=col; i&lt;=m; ++i)</span><br><span class="line">            swap (a[sel][i], a[row][i]);</span><br><span class="line">        where[col] = row;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; ++i)</span><br><span class="line">            <span class="keyword">if</span> (i != row) &#123;</span><br><span class="line">                <span class="keyword">double</span> c = a[i][col] / a[row][col];</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j=col; j&lt;=m; ++j)</span><br><span class="line">                    a[i][j] -= a[row][j] * c;</span><br><span class="line">            &#125;</span><br><span class="line">        ++row;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ans.assign (m, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;m; ++i)</span><br><span class="line">        <span class="keyword">if</span> (where[i] != <span class="number">-1</span>)</span><br><span class="line">            ans[i] = a[where[i]][m] / a[where[i]][i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; ++i) &#123;</span><br><span class="line">        <span class="keyword">double</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;m; ++j)</span><br><span class="line">            sum += ans[j] * a[i][j];</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">abs</span> (sum - a[i][m]) &gt; EPS)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;m; ++i)</span><br><span class="line">        <span class="keyword">if</span> (where[i] == <span class="number">-1</span>)</span><br><span class="line">            <span class="keyword">return</span> INF;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, m;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; &gt; <span class="title">a</span><span class="params">(n, <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt;(m + <span class="number">1</span>))</span></span>;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; <span class="title">ans</span><span class="params">(m)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= m; ++j) &#123;</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; a[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> s = gauss(a, ans);</span><br><span class="line">    <span class="keyword">if</span>(s == <span class="number">0</span>) <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;NO&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(s == INF) <span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;MANY&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">double</span> &amp;i : ans) &#123;</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4><span id="等价矩阵-on3">等价矩阵 O(n^3)</span></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> EPS = <span class="number">1E-9</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> rank = max(n,m);</span><br><span class="line"><span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt; <span class="title">line_used</span> <span class="params">(n)</span></span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;m; ++i) &#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="keyword">for</span> (j=<span class="number">0</span>; j&lt;n; ++j)</span><br><span class="line">        <span class="keyword">if</span> (!line_used[j] &amp;&amp; <span class="built_in">abs</span>(a[j][i]) &gt; EPS)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> (j == n)</span><br><span class="line">        --rank;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        line_used[j] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p=i+<span class="number">1</span>; p&lt;m; ++p)</span><br><span class="line">            a[j][p] /= a[j][i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k=<span class="number">0</span>; k&lt;n; ++k)</span><br><span class="line">            <span class="keyword">if</span> (k != j &amp;&amp; <span class="built_in">abs</span> (a[k][i]) &gt; EPS)</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> p=i+<span class="number">1</span>; p&lt;m; ++p)</span><br><span class="line">                    a[k][p] -= a[j][p] * a[k][i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4><span id="行列式的值-on3">行列式的值 O(n^3)</span></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> EPS = <span class="number">1E-9</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="built_in">vector</span> &lt; <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; &gt; a (n, <span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; (n));</span><br><span class="line">... чтение n и a ...</span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> det = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; ++i) &#123;</span><br><span class="line">    <span class="keyword">int</span> k = i;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j=i+<span class="number">1</span>; j&lt;n; ++j)</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">abs</span> (a[j][i]) &gt; <span class="built_in">abs</span> (a[k][i]))</span><br><span class="line">            k = j;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">abs</span> (a[k][i]) &lt; EPS) &#123;</span><br><span class="line">        det = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    swap (a[i], a[k]);</span><br><span class="line">    <span class="keyword">if</span> (i != k)</span><br><span class="line">        det = -det;</span><br><span class="line">    det *= a[i][i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j=i+<span class="number">1</span>; j&lt;n; ++j)</span><br><span class="line">        a[i][j] /= a[i][i];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j=<span class="number">0</span>; j&lt;n; ++j)</span><br><span class="line">        <span class="keyword">if</span> (j != i &amp;&amp; <span class="built_in">abs</span> (a[j][i]) &gt; EPS)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k=i+<span class="number">1</span>; k&lt;n; ++k)</span><br><span class="line">                a[j][k] -= a[i][k] * a[j][i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; det;</span><br></pre></td></tr></table></figure>
<h4><span id="离散数对">离散数对</span></h4><p>$a ^ x ≡ b \mod {m}$ 以知 $a,b,m$ 求解 $x$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span> <span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = (<span class="keyword">int</span>) <span class="built_in">sqrt</span> (m + <span class="number">.0</span>) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> an = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; ++i)</span><br><span class="line">        an = (an * a) % m;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">map</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; vals;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>, cur=an; i&lt;=n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!vals.count(cur))</span><br><span class="line">            vals[cur] = i;</span><br><span class="line">        cur = (cur * an) % m;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>, cur=b; i&lt;=n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (vals.count(cur)) &#123;</span><br><span class="line">            <span class="keyword">int</span> ans = vals[cur] * n - i;</span><br><span class="line">            <span class="keyword">if</span> (ans &lt; m)</span><br><span class="line">                <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">        cur = (cur * a) % m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>离散根提取</strong></p>
<p>$x ^ k ≡ a  \mod {n}$</p>
<p>我们提供了一个完整的实现，包括查找原始根，离散对数以及查找和输出所有解。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span> <span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a ? gcd (b%a, a) : b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">powmod</span> <span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b)</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            res = <span class="keyword">int</span> (res * <span class="number">1l</span>l * a % p),  --b;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            a = <span class="keyword">int</span> (a * <span class="number">1l</span>l * a % p),  b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">generator</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; fact;</span><br><span class="line">    <span class="keyword">int</span> phi = p<span class="number">-1</span>,  n = phi;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>; i*i&lt;=n; ++i)</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">            fact.push_back (i);</span><br><span class="line">            <span class="keyword">while</span> (n % i == <span class="number">0</span>)</span><br><span class="line">                n /= i;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)</span><br><span class="line">        fact.push_back (n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> res=<span class="number">2</span>; res&lt;=p; ++res) &#123;</span><br><span class="line">        <span class="keyword">bool</span> ok = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>; i&lt;fact.size() &amp;&amp; ok; ++i)</span><br><span class="line">            ok &amp;= powmod (res, phi / fact[i], p) != <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (ok)  <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n, k, a;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k &gt;&gt; a;</span><br><span class="line">    <span class="keyword">if</span> (a == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span> (<span class="string">&quot;1\n0&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> g = generator (n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> sq = (<span class="keyword">int</span>) <span class="built_in">sqrt</span> (n + <span class="number">.0</span>) + <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">vector</span> &lt; <span class="built_in">pair</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &gt; dec (sq);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=sq; ++i)</span><br><span class="line">        dec[i<span class="number">-1</span>] = <span class="built_in">make_pair</span> (powmod (g, <span class="keyword">int</span> (i * sq * <span class="number">1l</span>l * k % (n - <span class="number">1</span>)), n), i);</span><br><span class="line">    sort (dec.begin(), dec.end());</span><br><span class="line">    <span class="keyword">int</span> any_ans = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;sq; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> my = <span class="keyword">int</span> (powmod (g, <span class="keyword">int</span> (i * <span class="number">1l</span>l * k % (n - <span class="number">1</span>)), n) * <span class="number">1l</span>l * a % n);</span><br><span class="line">        <span class="built_in">vector</span> &lt; <span class="built_in">pair</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; &gt;::iterator it =</span><br><span class="line">            lower_bound (dec.begin(), dec.end(), <span class="built_in">make_pair</span> (my, <span class="number">0</span>));</span><br><span class="line">        <span class="keyword">if</span> (it != dec.end() &amp;&amp; it-&gt;first == my) &#123;</span><br><span class="line">            any_ans = it-&gt;second * sq - i;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (any_ans == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="built_in">puts</span> (<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> delta = (n<span class="number">-1</span>) / gcd (k, n<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> cur=any_ans%delta; cur&lt;n<span class="number">-1</span>; cur+=delta)</span><br><span class="line">        ans.push_back (powmod (g, cur, n));</span><br><span class="line">    sort (ans.begin(), ans.end());</span><br><span class="line">    <span class="built_in">printf</span> (<span class="string">&quot;%d\n&quot;</span>, ans.size());</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>; i&lt;ans.size(); ++i)</span><br><span class="line">        <span class="built_in">printf</span> (<span class="string">&quot;%d &quot;</span>, ans[i]);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4><span id="格雷码">格雷码</span></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">g</span> <span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> n ^ (n &gt;&gt; <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">rev_g</span> <span class="params">(<span class="keyword">int</span> g)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (; g; g&gt;&gt;=<span class="number">1</span>) n ^= g;</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4><span id="求阶乘-op-log_p-n">求阶乘 $O(p \log_p n).$</span></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">factmod</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (n &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        res = (res * ((n/p) % <span class="number">2</span> ? p<span class="number">-1</span> : <span class="number">1</span>)) % p;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>; i&lt;=n%p; ++i)</span><br><span class="line">            res = (res * i) % p;</span><br><span class="line">        n /= p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res % p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4><span id="原根">原根</span></h4><p>如果它 $g$ 是一个原始根模数 $n$ ，那么对于任何一这样$gcd（a，n）= 1$的整数，都有一个 $ķ$ 这样的整数 $g ^ k ≡ a  \mod {n}$。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">powmod</span> <span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (b)</span><br><span class="line">        <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">            res = <span class="keyword">int</span> (res * <span class="number">1l</span>l * a % p),  --b;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            a = <span class="keyword">int</span> (a * <span class="number">1l</span>l * a % p),  b &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">generator</span> <span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; fact;</span><br><span class="line">    <span class="keyword">int</span> phi = p<span class="number">-1</span>,  n = phi;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">2</span>; i*i&lt;=n; ++i)</span><br><span class="line">        <span class="keyword">if</span> (n % i == <span class="number">0</span>) &#123;</span><br><span class="line">            fact.push_back (i);</span><br><span class="line">            <span class="keyword">while</span> (n % i == <span class="number">0</span>)</span><br><span class="line">                n /= i;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>)</span><br><span class="line">        fact.push_back (n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> res=<span class="number">2</span>; res&lt;=p; ++res) &#123;</span><br><span class="line">        <span class="keyword">bool</span> ok = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>; i&lt;fact.size() &amp;&amp; ok; ++i)</span><br><span class="line">            ok &amp;= powmod (res, phi / fact[i], p) != <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (ok)  <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4><span id="卡特兰数应用">卡特兰数应用</span></h4><ul>
<li>由 $n$ 开 $n$ 括号和右括号组成的有效括号序列的数量。</li>
<li>带 $n + 1$ 叶子的根二叉树的数量（顶点没有编号）。</li>
<li>完全划分 $n + 1$ 乘数的方法的数量。</li>
<li>凸 $n + 2$ 角的三角测量的数量（即，通过将对角线不相交成三角形的多边形的分区数）。</li>
<li>连接 $2N$ 圆上的点与 $n$ 非交叉和弦的方法的数量。</li>
<li>具有ñ内部顶点的非同构完整二叉树的数量（即，至少有一个子）。</li>
<li>从点数量单调路径 $（0,0）$ 指向 $（n，n）$ 在一个方形网格尺寸 $n \times n$ 上方的主对角线没有上升。</li>
<li>$n$ 可以通过堆栈排序的长度排列的数量（当且仅当没有这样的索引时 $i&lt;j &lt;k$，可以显示排列按堆栈排序 $a_k &lt;a_i &lt;a_j$ ）。</li>
<li>一组 $n$ 元素的连续分区数（即分区为连续块）。</li>
<li>$1 \ldots n$ 使用 $n$ 矩形覆盖梯子的方式的数量（意味着由 $n$ 列组成的图，其中一个我具有高度我）。</li>
</ul>
<h4><span id="康托展开求任意排列的排名">康托展开（求任意排列的排名）</span></h4><p>康托展开可以用来求一个 $1\sim n$ 的任意排列的排名。</p>
<h5><span id="什么是排列的排名">什么是排列的排名？</span></h5><p>把 $1\sim n$ 的所有排列按字典序排序，这个排列的位次就是它的排名。</p>
<h5><span id="时间复杂度">时间复杂度？</span></h5><p>康托展开可以在 $O(n^2)$ 的复杂度内求出一个排列的排名，在用到树状数组优化时可以做到 $O(n\log n)$ 。</p>
<h5><span id="怎么实现">怎么实现？</span></h5><p>因为排列是按字典序排名的，因此越靠前的数字优先级越高。也就是说如果两个排列的某一位之前的数字都相同，那么如果这一位如果不相同，就按这一位排序。</p>
<p>比如 $4$ 的排列，$[2,3,1,4]&lt;[2,3,4,1]$，因为在第 $3$ 位出现不同，则 $[2,3,1,4]$ 的排名在 $[2,3,4,1]$ 前面。</p>
<h5><span id="举个栗子">举个栗子</span></h5><p>我们知道长为 $5$ 的排列 $[2,5,3,4,1]$ 大于以 $1$ 为第一位的任何排列，以 $1$ 为第一位的 $5$ 的排列有 $4!$ 种。这是非常好理解的。但是我们对第二位的 $5$ 而言，它大于<strong>第一位与这个排列相同的，而这一位比 $5$ 小的</strong>所有排列。不过我们要注意的是，这一位不仅要比 $5$ 小，还要满足没有在当前排列的前面出现过，不然统计就重复了。因此这一位为 $1,3$ 或 $4$ ，第一位为 $2$ 的所有排列都比它要小，数量为 $3\times 3!$。</p>
<p>按照这样统计下去，答案就是 $1+4!+3\times 3!+2!+1=46$。注意我们统计的是排名，因此最前面要 $+1$。</p>
<p>注意到我们每次要用到<strong>当前有多少个小于它的数还没有出现</strong>，这里用树状数组统计比它小的数出现过的次数就可以了。</p>
<h5><span id="逆康托展开">逆康托展开</span></h5><p>因为排列的排名和排列是一一对应的，所以康托展开满足双射关系，是可逆的。可以通过类似上面的过程倒推回来。</p>
<p>如果我们知道一个排列的排名，就可以推出这个排列。因为 $4!$ 是严格大于 $3\times 3!+2\times 2!+1\times 1!$ 的，所以可以认为对于长度为 $5$ 的排列，排名 $x$ 除以 $4!$ 向下取整就是有多少个数小于这个排列的第一位。</p>
<h5><span id="引用上面展开的例子">引用上面展开的例子</span></h5><p>首先让 $46-1=45$，$45$ 代表着有多少个排列比这个排列小。$\lfloor\frac {45}{4!}\rfloor=1$，有一个数小于它，所以第一位是 $2$。</p>
<p>此时让排名减去 $1\times 4!$得到$21$，$\lfloor\frac {21}{3!}\rfloor=3$，有 $3$ 个数小于它，去掉已经存在的 $2$，这一位是 $5$。</p>
<p>$21-3\times 3!=3$，$\lfloor\frac {3}{2!}\rfloor=1$，有一个数小于它，那么这一位就是 $3$。</p>
<p>让 $3-1\times 2!=1$，有一个数小于它，这一位是剩下来的第二位，$4$，剩下一位就是 $1$。即 $[2,5,3,4,1]$。</p>
<p>实际上我们得到了形如<strong>有两个数小于它</strong>这一结论，就知道它是当前第 $3$ 个没有被选上的数，这里也可以用线段树维护，时间复杂度为 $O(n\log n)$。</p>
<h4><span id="约瑟夫">约瑟夫</span></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">joseph</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> n&gt;<span class="number">1</span> ? (joseph (n<span class="number">-1</span>, k) + k - <span class="number">1</span>) % n + <span class="number">1</span> : <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">joseph</span> <span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">1</span>)  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (k == <span class="number">1</span>)  <span class="keyword">return</span> n<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (k &gt; n)  <span class="keyword">return</span> (joseph (n<span class="number">-1</span>, k) + k) % n;</span><br><span class="line">    <span class="keyword">int</span> cnt = n / k;</span><br><span class="line">    <span class="keyword">int</span> res = joseph (n - cnt, k);</span><br><span class="line">    res -= n % k;</span><br><span class="line">    <span class="keyword">if</span> (res &lt; <span class="number">0</span>)  res += n;</span><br><span class="line">    <span class="keyword">else</span>  res += res / (k - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4><span id="stirling-数子集划分">Stirling 数（子集划分）</span></h4><p>根据例题来讲解：<br><br>（2007 普及）将$n$个数$（1，2，…，n）$分成$r$个部分。每个部分至少一个数。将不同划分方法的总数记为$S_n^r$。例如，$S_4^2=7$，这 7 种不同的划分方法依次为 $\{ (1) , (234) \}\,\{ (2) ,  (134) \}\,\{ (3) , (124) \}\,\{ (4) , (123) \}\,\{ (12) , (34) \}\,\{ (13) , (24) \}\,\{ (14) , (23) \}$。当$n=6，r=3$时，$S_6^3$=（    ）<br></p>
<blockquote>
<p>提示：先固定一个数，对于其余的 5 个数考虑$S_5^3$与$S_5^2$，再分这两种情况对原固定的数进行分析。</p>
</blockquote>
<p>题解：在近几年算法竞赛中，递推算法越来越重要：</p>
<script type="math/tex; mode=display">
S_6^3=3 \times S_5^3 + S_5^2</script><script type="math/tex; mode=display">
S_5^3=3 \times S_4^3 + S_4^2</script><script type="math/tex; mode=display">
S_5^2=2 \times S_4^2 + S_4^1</script><p>第二类 stirling 数，显然拥有这样的性质：</p>
<script type="math/tex; mode=display">
S_n^m = m \times S_{n-1}^{m} + S_{n-1}^{m-1}</script><script type="math/tex; mode=display">
S_n^1 = 1,S_n^0 = 0,S_n^n = 1</script><p>而这些性质就可以总结成：</p>
<script type="math/tex; mode=display">
S_n^3 = \frac{1}{2} \times (3^{n-1}+1) - 2^{n-1}</script><h4><span id="整数拆分">整数拆分</span></h4><p>正整数n的有序k分拆的个数等于</p>
<script type="math/tex; mode=display">p_k(n)=\binom{n-1}{k-1}</script><p>$p_0(0)=1, p_k(0)=0, p_1(n)=1, p_n(n)=1$<br>$p_k(n)=p_1(n-k)+p_2(n-k)+\ldots +p_k(n-k) =p_{k-1}(n-1)+p_k(n-k)$</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>n个球</th>
<th>r 个盒子</th>
<th>是否允许有空盒</th>
<th>分配方案数</th>
</tr>
</thead>
<tbody>
<tr>
<td>不同</td>
<td>不同</td>
<td>允许</td>
<td>$r^n$</td>
</tr>
<tr>
<td>不同</td>
<td>不同</td>
<td>不允许</td>
<td>$r!S(n,r)$</td>
</tr>
<tr>
<td>不同</td>
<td>相同</td>
<td>允许</td>
<td>$\sum_{k=1}^{r}S(n,k)$</td>
</tr>
<tr>
<td>不同</td>
<td>相同</td>
<td>不允许</td>
<td>$S(n,r)$</td>
</tr>
<tr>
<td>相同</td>
<td>不同</td>
<td>允许</td>
<td>$C(n+r-1, n)$</td>
</tr>
<tr>
<td>相同</td>
<td>不同</td>
<td>不允许</td>
<td>$C(n-1, r-1)$</td>
</tr>
<tr>
<td>相同</td>
<td>相同</td>
<td>允许</td>
<td>$\sum_{k=1}^{r}p_k(n)$</td>
</tr>
<tr>
<td>相同</td>
<td>相同</td>
<td>不允许</td>
<td>$p_r(n)$</td>
</tr>
</tbody>
</table>
</div>
<p>$S(n,r)$  为斯特林数</p>
<h2><span id="博弈">博弈</span></h2><h4><span id="任意图表上的博弈">任意图表上的博弈</span></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; g [<span class="number">100</span>];</span><br><span class="line"><span class="keyword">bool</span> win [<span class="number">100</span>];</span><br><span class="line"><span class="keyword">bool</span> loose [<span class="number">100</span>];</span><br><span class="line"><span class="keyword">bool</span> used[<span class="number">100</span>];</span><br><span class="line"><span class="keyword">int</span> degree[<span class="number">100</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span> <span class="params">(<span class="keyword">int</span> v)</span> </span>&#123;</span><br><span class="line">    used[v] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;::iterator i = g[v].begin(); i != g[v].end(); ++i)</span><br><span class="line">        <span class="keyword">if</span> (!used[*i]) &#123;</span><br><span class="line">            <span class="keyword">if</span> (loose[v])</span><br><span class="line">                win[*i] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (--degree[*i] == <span class="number">0</span>)</span><br><span class="line">                loose[*i] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            dfs (*i);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4><span id="fft">FFT</span></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">complex</span>&lt;<span class="keyword">double</span>&gt; <span class="keyword">complex_t</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1</span> &lt;&lt; <span class="number">21</span>;</span><br><span class="line"><span class="keyword">complex_t</span> A[MAXN], B[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">complex_t</span> w[MAXN + <span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> bitrev[MAXN + <span class="number">5</span>];</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i, l, r) for(int i = l; i &lt; r; ++i)</span></span><br><span class="line"><span class="keyword">int</span> N, L;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(<span class="keyword">complex_t</span> *a, <span class="keyword">int</span> op = <span class="number">1</span>, <span class="keyword">int</span> n = N)</span> </span>&#123;  <span class="comment">// op 1 时是 DFT，on == -1 时是 IDFT</span></span><br><span class="line">    rep(i, <span class="number">0</span>, n) <span class="keyword">if</span> (i &lt; bitrev[i]) swap(a[i], a[bitrev[i]]);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>, lyc = n &gt;&gt; <span class="number">1</span>; i &lt;= n; i &lt;&lt;= <span class="number">1</span>, lyc &gt;&gt;= <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j += i) &#123;</span><br><span class="line">            <span class="keyword">complex_t</span> *l = a + j, *r = a + j + (i &gt;&gt; <span class="number">1</span>), *p = w;</span><br><span class="line">            rep(k, <span class="number">0</span>, i &gt;&gt; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">complex_t</span> tmp = *r * *p;</span><br><span class="line">                *r = *l - tmp, *l = *l + tmp;</span><br><span class="line">                ++l, ++r, p += lyc;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">if</span>(op == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) &#123;</span><br><span class="line">            a[i] = <span class="keyword">complex_t</span>(a[i].real() / N, a[i].imag() / N);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fft_prepare</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123; <span class="comment">//init</span></span><br><span class="line">    L = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> ( ; (<span class="number">1</span> &lt;&lt; L) &lt; n - <span class="number">1</span>; ++L);</span><br><span class="line">    N = <span class="number">1</span> &lt;&lt; L;</span><br><span class="line">    rep(i, <span class="number">0</span>, N) bitrev[i] = bitrev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span> | ((i &amp; <span class="number">1</span>) &lt;&lt; (L - <span class="number">1</span>));</span><br><span class="line">    rep(i, <span class="number">0</span>, N) w[i] = <span class="keyword">complex_t</span>(<span class="built_in">cos</span>(<span class="number">2</span> * PI * i / N), <span class="built_in">sin</span>(<span class="number">2</span> * PI * i / N));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n; <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">	fft_prepare(n);</span><br><span class="line">	FFT(A, <span class="number">1</span>);</span><br><span class="line">	FFT(A, <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i) A[i] *= B[i];</span><br><span class="line">	FFT(A, <span class="number">-1</span>);</span><br><span class="line">	<span class="comment">// (int)(A[i].real() + 0.5)</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2><span id="计算几何">计算几何</span></h2><h4><span id="on-求简单多边形面积">O(N) 求简单多边形面积</span></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">sq</span> <span class="params">(<span class="keyword">const</span> <span class="built_in">vector</span>&lt;point&gt; &amp; fig)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">unsigned</span> i=<span class="number">0</span>; i&lt;fig.size(); i++) &#123;</span><br><span class="line">        point</span><br><span class="line">            p1 = i ? fig[i<span class="number">-1</span>] : fig.back(),</span><br><span class="line">            p2 = fig[i];</span><br><span class="line">        res += (p1.x - p2.x) * (p1.y + p2.y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span> (res) / <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4><span id="凸多边形内接圆">凸多边形内接圆</span></h4><p>先三分圆心的 $x$ 坐标，再三分圆心的 $y$ 坐标，$O(N \log ^2 C)$</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> EPS = <span class="number">1E-9</span>;</span><br><span class="line"><span class="keyword">int</span> steps = <span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pt</span> &#123;</span></span><br><span class="line">	<span class="keyword">double</span> x, y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">line</span> &#123;</span></span><br><span class="line">	<span class="keyword">double</span> a, b, c;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dist</span> <span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y, line &amp; l)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">abs</span> (x * l.a + y * l.b + l.c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">radius</span> <span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y, <span class="built_in">vector</span>&lt;line&gt; &amp; l)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = (<span class="keyword">int</span>) l.size();</span><br><span class="line">	<span class="keyword">double</span> res = INF;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; ++i)</span><br><span class="line">		res = min (res, dist (x, y, l[i]));</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">y_radius</span> <span class="params">(<span class="keyword">double</span> x, <span class="built_in">vector</span>&lt;pt&gt; &amp; a, <span class="built_in">vector</span>&lt;line&gt; &amp; l)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> n = (<span class="keyword">int</span>) a.size();</span><br><span class="line">	<span class="keyword">double</span> ly = INF,  ry = -INF;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; ++i) &#123;</span><br><span class="line">		<span class="keyword">int</span> x1 = a[i].x,  x2 = a[(i+<span class="number">1</span>)%n].x,  y1 = a[i].y,  y2 = a[(i+<span class="number">1</span>)%n].y;</span><br><span class="line">		<span class="keyword">if</span> (x1 == x2)  <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">if</span> (x1 &gt; x2)  swap (x1, x2),  swap (y1, y2);</span><br><span class="line">		<span class="keyword">if</span> (x1 &lt;= x+EPS &amp;&amp; x-EPS &lt;= x2) &#123;</span><br><span class="line">			<span class="keyword">double</span> y = y1 + (x - x1) * (y2 - y1) / (x2 - x1);</span><br><span class="line">			ly = min (ly, y);</span><br><span class="line">			ry = max (ry, y);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> sy=<span class="number">0</span>; sy&lt;steps; ++sy) &#123;</span><br><span class="line">		<span class="keyword">double</span> diff = (ry - ly) / <span class="number">3</span>;</span><br><span class="line">		<span class="keyword">double</span> y1 = ly + diff,  y2 = ry - diff;</span><br><span class="line">		<span class="keyword">double</span> f1 = radius (x, y1, l),  f2 = radius (x, y2, l);</span><br><span class="line">		<span class="keyword">if</span> (f1 &lt; f2)</span><br><span class="line">			ly = y1;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			ry = y2;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> radius (x, ly, l);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="function"><span class="built_in">vector</span>&lt;pt&gt; <span class="title">a</span> <span class="params">(n)</span></span>;</span><br><span class="line">	... чтение a ...</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="built_in">vector</span>&lt;line&gt; <span class="title">l</span> <span class="params">(n)</span></span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; ++i) &#123;</span><br><span class="line">		l[i].a = a[i].y - a[(i+<span class="number">1</span>)%n].y;</span><br><span class="line">		l[i].b = a[(i+<span class="number">1</span>)%n].x - a[i].x;</span><br><span class="line">		<span class="keyword">double</span> sq = <span class="built_in">sqrt</span> (l[i].a*l[i].a + l[i].b*l[i].b);</span><br><span class="line">		l[i].a /= sq,  l[i].b /= sq;</span><br><span class="line">		l[i].c = - (l[i].a * a[i].x + l[i].b * a[i].y);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> lx = INF,  rx = -INF;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; ++i) &#123;</span><br><span class="line">		lx = min (lx, a[i].x);</span><br><span class="line">		rx = max (rx, a[i].x);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> sx=<span class="number">0</span>; sx&lt;stepsx; ++sx) &#123;</span><br><span class="line">		<span class="keyword">double</span> diff = (rx - lx) / <span class="number">3</span>;</span><br><span class="line">		<span class="keyword">double</span> x1 = lx + diff,  x2 = rx - diff;</span><br><span class="line">		<span class="keyword">double</span> f1 = y_radius (x1, a, l),  f2 = y_radius (x2, a, l);</span><br><span class="line">		<span class="keyword">if</span> (f1 &lt; f2)</span><br><span class="line">			lx = x1;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			rx = x2;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> ans = y_radius (lx, a, l);</span><br><span class="line">	<span class="built_in">printf</span> (<span class="string">&quot;%.7lf&quot;</span>, ans);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4><span id="通过缩小边的方法在凸多边形中找到内切圆-on-log-n">通过“缩小边”的方法在凸多边形中找到内切圆 O（n  log n）</span></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> EPS = <span class="number">1E-9</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = ...;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">pt</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">    pt()  &#123; &#125;</span><br><span class="line">    pt (<span class="keyword">double</span> x, <span class="keyword">double</span> y) : x(x), y(y)  &#123; &#125;</span><br><span class="line">    pt <span class="keyword">operator</span>- (<span class="keyword">const</span> pt &amp; p) <span class="keyword">const</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> pt (x-p.x, y-p.y);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">dist</span> <span class="params">(<span class="keyword">const</span> pt &amp; a, <span class="keyword">const</span> pt &amp; b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span> ((a.x-b.x)*(a.x-b.x) + (a.y-b.y)*(a.y-b.y));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">get_ang</span> <span class="params">(<span class="keyword">const</span> pt &amp; a, <span class="keyword">const</span> pt &amp; b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> ang = <span class="built_in">abs</span> (<span class="built_in">atan2</span> (a.y, a.x) - <span class="built_in">atan2</span> (b.y, b.x));</span><br><span class="line">    <span class="keyword">return</span> min (ang, <span class="number">2</span>*PI-ang);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">line</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> a, b, c;</span><br><span class="line">    line (<span class="keyword">const</span> pt &amp; p, <span class="keyword">const</span> pt &amp; q) &#123;</span><br><span class="line">        a = p.y - q.y;</span><br><span class="line">        b = q.x - p.x;</span><br><span class="line">        c = - a * p.x - b * p.y;</span><br><span class="line">        <span class="keyword">double</span> z = <span class="built_in">sqrt</span> (a*a + b*b);</span><br><span class="line">        a/=z, b/=z, c/=z;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">det</span> <span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b, <span class="keyword">double</span> c, <span class="keyword">double</span> d)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a * d - b * c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">pt <span class="title">intersect</span> <span class="params">(<span class="keyword">const</span> line &amp; n, <span class="keyword">const</span> line &amp; m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> zn = det (n.a, n.b, m.a, m.b);</span><br><span class="line">    <span class="keyword">return</span> pt (</span><br><span class="line">        - det (n.c, n.b, m.c, m.b) / zn,</span><br><span class="line">        - det (n.a, n.c, m.a, m.c) / zn</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">parallel</span> <span class="params">(<span class="keyword">const</span> line &amp; n, <span class="keyword">const</span> line &amp; m)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span> (det (n.a, n.b, m.a, m.b)) &lt; EPS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">get_h</span> <span class="params">(<span class="keyword">const</span> pt &amp; p1, <span class="keyword">const</span> pt &amp; p2,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="keyword">const</span> pt &amp; l1, <span class="keyword">const</span> pt &amp; l2, <span class="keyword">const</span> pt &amp; r1, <span class="keyword">const</span> pt &amp; r2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    pt q1 = intersect (line (p1, p2), line (l1, l2));</span><br><span class="line">    pt q2 = intersect (line (p1, p2), line (r1, r2));</span><br><span class="line">    <span class="keyword">double</span> l = dist (q1, q2);</span><br><span class="line">    <span class="keyword">double</span> alpha = get_ang (l2 - l1, p2 - p1) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">double</span> beta = get_ang (r2 - r1, p1 - p2) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">return</span> l * <span class="built_in">sin</span>(alpha) * <span class="built_in">sin</span>(beta) / <span class="built_in">sin</span>(alpha+beta);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">cmp</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(<span class="keyword">const</span> <span class="built_in">pair</span>&lt;<span class="keyword">double</span>,<span class="keyword">int</span>&gt; &amp; a, <span class="keyword">const</span> <span class="built_in">pair</span>&lt;<span class="keyword">double</span>,<span class="keyword">int</span>&gt; &amp; b)</span> <span class="keyword">const</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">abs</span> (a.first - b.first) &gt; EPS)</span><br><span class="line">            <span class="keyword">return</span> a.first &lt; b.first;</span><br><span class="line">        <span class="keyword">return</span> a.second &lt; b.second;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">vector</span>&lt;pt&gt; p;</span><br><span class="line">    ... чтение n и p ...</span><br><span class="line"></span><br><span class="line">    vector&lt;int&gt; next (n), prev (n);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; ++i) &#123;</span><br><span class="line">        next[i] = (i + <span class="number">1</span>) % n;</span><br><span class="line">        prev[i] = (i - <span class="number">1</span> + n) % n;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">set</span> &lt; <span class="built_in">pair</span>&lt;<span class="keyword">double</span>,<span class="keyword">int</span>&gt;, cmp &gt; q;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; <span class="title">h</span> <span class="params">(n)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; ++i) &#123;</span><br><span class="line">        h[i] = get_h (</span><br><span class="line">            p[i], p[next[i]],</span><br><span class="line">            p[i], p[prev[i]],</span><br><span class="line">            p[next[i]], p[next[next[i]]]</span><br><span class="line">        );</span><br><span class="line">        q.insert (<span class="built_in">make_pair</span> (h[i], i));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> last_time;</span><br><span class="line">    <span class="keyword">while</span> (q.size() &gt; <span class="number">2</span>) &#123;</span><br><span class="line">        last_time = q.begin()-&gt;first;</span><br><span class="line">        <span class="keyword">int</span> i = q.begin()-&gt;second;</span><br><span class="line">        q.erase (q.begin());</span><br><span class="line"></span><br><span class="line">        next[prev[i]] = next[i];</span><br><span class="line">        prev[next[i]] = prev[i];</span><br><span class="line">        <span class="keyword">int</span> nxt = next[i],   nxt1 = (nxt+<span class="number">1</span>)%n,</span><br><span class="line">            prv = prev[i],   prv1 = (prv+<span class="number">1</span>)%n;</span><br><span class="line">        <span class="keyword">if</span> (parallel (line (p[nxt], p[nxt1]), line (p[prv], p[prv1])))</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        q.erase (<span class="built_in">make_pair</span> (h[nxt], nxt));</span><br><span class="line">        q.erase (<span class="built_in">make_pair</span> (h[prv], prv));</span><br><span class="line"></span><br><span class="line">        h[nxt] = get_h (</span><br><span class="line">            p[nxt], p[nxt1],</span><br><span class="line">            p[prv1], p[prv],</span><br><span class="line">            p[next[nxt]], p[(next[nxt]+<span class="number">1</span>)%n]</span><br><span class="line">        );</span><br><span class="line">        h[prv] = get_h (</span><br><span class="line">            p[prv], p[prv1],</span><br><span class="line">            p[(prev[prv]+<span class="number">1</span>)%n], p[prev[prv]],</span><br><span class="line">            p[nxt], p[nxt1]</span><br><span class="line">        );</span><br><span class="line"></span><br><span class="line">        q.insert (<span class="built_in">make_pair</span> (h[nxt], nxt));</span><br><span class="line">        q.insert (<span class="built_in">make_pair</span> (h[prv], prv));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; last_time &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4><span id="找到三角形联合的区域-垂直分解法">找到三角形联合的区域。垂直分解法</span></h4><p>给定N个三角形。需要找到他们关联的区域。</p>
<h5><span id="决定">决定</span></h5><p>这里我们考虑垂直分解的方法，这在几何问题中通常非常重要。</p>
<p>所以，我们有N个三角形可以以任何方式相互交叉。我们将在垂直分解的帮助下摆脱这些交叉点：我们将找到所有段的所有交叉点（形成三角形），并通过其横坐标对找到的点进行排序。假设我们得到了一些数组B.让我们沿着这个数组移动。在第i步，我们考虑元素B [i]和B [i + 1]。我们在直线X = B [i]和X = B [i + 1]之间具有垂直条带，并且根据阵列B的结构，在该条带内，这些区段彼此不重叠。因此，在该条带内部，三角形被切割成梯形，并且条带内的这些梯形的侧面根本不相交。我们将从下往上沿着这些梯形的两侧移动，并折叠梯形区域，确保每个部分只教一次。实际上，这个过程与嵌套括号的处理非常相似。通过在每个条带内添加梯形区域，并为所有条带添加结果，我们将找到答案 - 三角形的并集区域。</p>
<p>让我们再一次考虑从实现的角度来看添加梯形区域的过程。我们迭代所有三角形的所有边，如果任何边（不垂直，我们不需要垂直边，甚至反之亦然，它们将阻挡）进入这个垂直条（完全或部分），然后我们把这边放在一些矢量以这种形式进行此操作最方便：侧面与垂直条带边界的交点处的Y坐标，以及三角形的编号。在我们构建了包含边的部分的这个向量之后，我们按Y的值排序：首先是左边的Y，然后是右边的Y.结果，向量中的第一个元素将包含最低梯形的下边。现在我们来看看收到的矢量。让我成为当前的元素; 这意味着第i件是一些梯形的底面，一些块（可能包含几个空格），我们想要立即添加到答案的区域。因此，我们将某个三角形计数器设置为1，然后向上移动，如果我们第一次遇到三角形的边，则增加计数器，如果我们第二次遇到三角形，则减少计数器。如果在某个段j上计数器变为等于零，那么我们找到了块的上边界 - 我们停在此处，添加由段i和j限定的梯形区域，并且我分配j + 1并再次重复整个过程。如果我们第一次遇到三角形的一侧，并减少计数器，如果我们第二次遇到三角形。如果在某个段j上计数器变为等于零，那么我们找到了块的上边界 - 我们停在此处，添加由段i和j限定的梯形区域，并且我分配j + 1并再次重复整个过程。如果我们第一次遇到三角形的一侧，并减少计数器，如果我们第二次遇到三角形。如果在某个段j上计数器变为等于零，那么我们找到了块的上边界 - 我们停在此处，添加由段i和j限定的梯形区域，并且我分配j + 1并再次重复整个过程。</p>
<p>因此，由于垂直分解方法，我们使用仅使用两个段的交集的几何图元来解决这个问题。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">segment</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> x1, y1, x2, y2;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">item</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> y1, y2;</span><br><span class="line">    <span class="keyword">int</span> triangle_id;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">line</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> a, b, c;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> EPS = <span class="number">1E-7</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">intersect</span> <span class="params">(segment s1, segment s2, <span class="built_in">vector</span>&lt;point&gt; &amp; res)</span> </span>&#123;</span><br><span class="line">    line l1 = &#123; s1.y1-s1.y2, s1.x2-s1.x1, l1.a*s1.x1+l1.b*s1.y1 &#125;,</span><br><span class="line">        l2 = &#123; s2.y1-s2.y2, s2.x2-s2.x1, l2.a*s2.x1+l2.b*s2.y1 &#125;;</span><br><span class="line">    <span class="keyword">double</span> det1 = l1.a * l2.b - l1.b * l2.a;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">abs</span> (det1) &lt; EPS)  <span class="keyword">return</span>;</span><br><span class="line">    point p = &#123; (l1.c * <span class="number">1.0</span> * l2.b - l1.b * <span class="number">1.0</span> * l2.c) / det1,</span><br><span class="line">        (l1.a * <span class="number">1.0</span> * l2.c - l1.c * <span class="number">1.0</span> * l2.a) / det1 &#125;;</span><br><span class="line">    <span class="keyword">if</span> (p.x &gt;= s1.x1-EPS &amp;&amp; p.x &lt;= s1.x2+EPS &amp;&amp; p.x &gt;= s2.x1-EPS &amp;&amp; p.x &lt;= s2.x2+EPS)</span><br><span class="line">        res.push_back (p);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">segment_y</span> <span class="params">(segment s, <span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> s.y1 + (s.y2 - s.y1) * (x - s.x1) / (s.x2 - s.x1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">eq</span> <span class="params">(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">abs</span> (a-b) &lt; EPS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;item&gt; c;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp_y1_y2</span> <span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> item &amp; a = c[i];</span><br><span class="line">    <span class="keyword">const</span> item &amp; b = c[j];</span><br><span class="line">    <span class="keyword">return</span> a.y1 &lt; b.y1-EPS || <span class="built_in">abs</span> (a.y1-b.y1) &lt; EPS &amp;&amp; a.y2 &lt; b.y2-EPS;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;segment&gt; <span class="title">a</span> <span class="params">(n*<span class="number">3</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> x1, y1, x2, y2, x3, y3;</span><br><span class="line">        <span class="built_in">scanf</span> (<span class="string">&quot;%d%d%d%d%d%d&quot;</span>, &amp;x1,&amp;y1,&amp;x2,&amp;y2,&amp;x3,&amp;y3);</span><br><span class="line">        segment s1 = &#123; x1,y1,x2,y2 &#125;;</span><br><span class="line">        segment s2 = &#123; x1,y1,x3,y3 &#125;;</span><br><span class="line">        segment s3 = &#123; x2,y2,x3,y3 &#125;;</span><br><span class="line">        a[i*<span class="number">3</span>] = s1;</span><br><span class="line">        a[i*<span class="number">3</span>+<span class="number">1</span>] = s2;</span><br><span class="line">        a[i*<span class="number">3</span>+<span class="number">2</span>] = s3;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>; i&lt;a.size(); ++i)</span><br><span class="line">        <span class="keyword">if</span> (a[i].x1 &gt; a[i].x2)</span><br><span class="line">            swap (a[i].x1, a[i].x2),  swap (a[i].y1, a[i].y2);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">vector</span>&lt;point&gt; b;</span><br><span class="line">    b.reserve (n*n*<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>; i&lt;a.size(); ++i)</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> j=i+<span class="number">1</span>; j&lt;a.size(); ++j)</span><br><span class="line">            intersect (a[i], a[j], b);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">double</span>&gt; <span class="title">xs</span> <span class="params">(b.size())</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>; i&lt;b.size(); ++i)</span><br><span class="line">        xs[i] = b[i].x;</span><br><span class="line">    sort (xs.begin(), xs.end());</span><br><span class="line">    xs.erase (unique (xs.begin(), xs.end(), &amp;eq), xs.end());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">double</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt; <span class="title">used</span> <span class="params">(n)</span></span>;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">cc</span> <span class="params">(n*<span class="number">3</span>)</span></span>;</span><br><span class="line">    c.resize (n*<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>; i+<span class="number">1</span>&lt;xs.size(); ++i) &#123;</span><br><span class="line">        <span class="keyword">double</span> x1 = xs[i],  x2 = xs[i+<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">size_t</span> csz = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> j=<span class="number">0</span>; j&lt;a.size(); ++j)</span><br><span class="line">            <span class="keyword">if</span> (a[j].x1 != a[j].x2)</span><br><span class="line">                <span class="keyword">if</span> (a[j].x1 &lt;= x1+EPS &amp;&amp; a[j].x2 &gt;= x2-EPS) &#123;</span><br><span class="line">                    item it = &#123; segment_y (a[j], x1), segment_y (a[j], x2), (<span class="keyword">int</span>)j/<span class="number">3</span> &#125;;</span><br><span class="line">                    cc[csz] = (<span class="keyword">int</span>)csz;</span><br><span class="line">                    c[csz++] = it;</span><br><span class="line">                &#125;</span><br><span class="line">        sort (cc.begin(), cc.begin()+csz, &amp;cmp_y1_y2);</span><br><span class="line">        <span class="keyword">double</span> add_res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">size_t</span> j=<span class="number">0</span>; j&lt;csz; ) &#123;</span><br><span class="line">            item lower = c[cc[j++]];</span><br><span class="line">            used[lower.triangle_id] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">int</span> cnt = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (cnt &amp;&amp; j&lt;csz) &#123;</span><br><span class="line">                <span class="keyword">char</span> &amp; cur = used[c[cc[j++]].triangle_id];</span><br><span class="line">                cur = !cur;</span><br><span class="line">                <span class="keyword">if</span> (cur)  ++cnt;  <span class="keyword">else</span>  --cnt;</span><br><span class="line">            &#125;</span><br><span class="line">            item upper = c[cc[j<span class="number">-1</span>]];</span><br><span class="line">            add_res += upper.y1 - lower.y1 + upper.y2 - lower.y2;</span><br><span class="line">        &#125;</span><br><span class="line">        res += add_res * (x2 - x1) / <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span>.precision (<span class="number">8</span>);</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; fixed &lt;&lt; res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4><span id="半平面交">半平面交</span></h4><ul>
<li>求凸多边形相交的面积</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">20010</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> tail, head, it;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> x, y;</span><br><span class="line">&#125; P[maxn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Line</span> &#123;</span></span><br><span class="line">    Point a, b;</span><br><span class="line">    <span class="keyword">double</span> angle;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getAngle</span><span class="params">()</span> </span>&#123;angle = <span class="built_in">atan2</span>(b.y-a.y, b.x-a.x);&#125;</span><br><span class="line">&#125; L[maxn], deq[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dcmp</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x &lt; -eps ? <span class="number">-1</span> : x &gt; eps;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">xmult</span><span class="params">(Point a, Point b, Point c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (a.x-c.x)*(b.y-c.y)-(a.y-c.y)*(b.x-c.x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Line u, Line v)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> d = dcmp(u.angle-v.angle);</span><br><span class="line">    <span class="keyword">if</span>(d) <span class="keyword">return</span> d &gt; <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> dcmp(xmult(u.a, v.a, v.b)) &gt; <span class="number">0</span>;</span><br><span class="line">    <span class="comment">///Clockwise:大于0取向量左半部分为半平面，小于0，取右半部分</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Point <span class="title">intersection</span><span class="params">(Line u, Line v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Point ret = u.a;</span><br><span class="line">    <span class="keyword">double</span> t = ((u.a.x-v.a.x)*(v.a.y-v.b.y)</span><br><span class="line">               -(u.a.y-v.a.y)*(v.a.x-v.b.x))</span><br><span class="line">             / ((u.a.x-u.b.x)*(v.a.y-v.b.y)</span><br><span class="line">               -(u.a.y-u.b.y)*(v.a.x-v.b.x));</span><br><span class="line">    ret.x += (u.b.x-u.a.x)*t, ret.y += (u.b.y-u.a.y)*t;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judge</span><span class="params">(Line l1, Line l2, Line l3)</span> </span>&#123;</span><br><span class="line">    Point p = intersection(l2, l3);</span><br><span class="line">    <span class="keyword">return</span> dcmp(xmult(p, l1.a, l1.b)) &lt; <span class="number">0</span>;</span><br><span class="line">    <span class="comment">///Clockwise:大于小于符号与上面cmp（）中注释处相反</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">HPI</span><span class="params">(Line L[], <span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    sort(L, L+n, cmp);</span><br><span class="line">    <span class="keyword">int</span> tmp = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(dcmp(L[i].angle-L[tmp<span class="number">-1</span>].angle) != <span class="number">0</span>) &#123;</span><br><span class="line">            L[tmp++] = L[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    n = tmp;</span><br><span class="line">    deq[<span class="number">0</span>] = L[<span class="number">0</span>], deq[<span class="number">1</span>] = L[<span class="number">1</span>];</span><br><span class="line">    head = <span class="number">0</span>, tail = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">while</span>(head &lt; tail &amp;&amp; judge(L[i], deq[tail<span class="number">-1</span>], deq[tail]))</span><br><span class="line">            tail--;</span><br><span class="line">        <span class="keyword">while</span>(head &lt; tail &amp;&amp; judge(L[i], deq[head+<span class="number">1</span>], deq[head]))</span><br><span class="line">            head++;</span><br><span class="line">        deq[++tail] = L[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(head &lt; tail &amp;&amp; judge(deq[head], deq[tail<span class="number">-1</span>], deq[tail]))</span><br><span class="line">        tail--;</span><br><span class="line">    <span class="keyword">while</span>(head &lt; tail &amp;&amp; judge(deq[tail], deq[head+<span class="number">1</span>], deq[head]))</span><br><span class="line">        head++;</span><br><span class="line">    <span class="keyword">if</span>(head == tail) <span class="keyword">return</span> ;</span><br><span class="line">    it = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = head; i &lt; tail; ++i) &#123;</span><br><span class="line">        P[it++] = intersection(deq[i], deq[i+<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(tail &gt; head+<span class="number">1</span>) &#123;</span><br><span class="line">        P[it++] = intersection(deq[head], deq[tail]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getArea</span><span class="params">(Point p[], <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> area = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n<span class="number">-1</span>; ++i) &#123;</span><br><span class="line">        area += xmult(P[<span class="number">0</span>], P[i], P[i+<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">fabs</span>(area)/<span class="number">2.0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">while</span>(~<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n)) &#123;</span><br><span class="line">        n += <span class="number">4</span>;</span><br><span class="line">        L[<span class="number">0</span>] = (Line)&#123;(Point)&#123;<span class="number">0</span>, <span class="number">10000</span>&#125;, (Point)&#123;<span class="number">0</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line">        L[<span class="number">1</span>] = (Line)&#123;(Point)&#123;<span class="number">10000</span>, <span class="number">10000</span>&#125;, (Point)&#123;<span class="number">0</span>, <span class="number">10000</span>&#125;&#125;;</span><br><span class="line">        L[<span class="number">2</span>] = (Line)&#123;(Point)&#123;<span class="number">10000</span>, <span class="number">0</span>&#125;, (Point)&#123;<span class="number">10000</span>, <span class="number">10000</span>&#125;&#125;;</span><br><span class="line">        L[<span class="number">3</span>] = (Line)&#123;(Point)&#123;<span class="number">0</span>, <span class="number">0</span>&#125;, (Point)&#123;<span class="number">10000</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line">        L[<span class="number">0</span>].getAngle(), L[<span class="number">1</span>].getAngle(), L[<span class="number">2</span>].getAngle(), L[<span class="number">3</span>].getAngle();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">4</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%lf%lf%lf%lf&quot;</span>, &amp;L[i].a.x, &amp;L[i].a.y, &amp;L[i].b.x, &amp;L[i].b.y);</span><br><span class="line">            L[i].getAngle();</span><br><span class="line">        &#125;</span><br><span class="line">        HPI(L, n);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.1f\n&quot;</span>, getArea(P, it));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2><span id="数据结构">数据结构</span></h2><h4><span id="笛卡尔树">笛卡尔树</span></h4><p>笛卡尔树是一种同时满足二叉搜索树和堆的性质的数据结构。 可在一个数组上构造出来（时间复杂度可以达到O(n))。树中节点有几个属性， key（节点元素的大小）、index（节点在原数组中的索引）、left（左子节点）、right（右子节点）、parent（父节点）。</p>
<p>性质</p>
<ul>
<li>树中的元素满足二叉搜索树性质，要求按照中序遍历得到的序列为原数组序列</li>
<li>树中节点满足堆性质，节点的key值要大于其左右子节点的key值</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        l[i] = <span class="number">0</span>, r[i] = <span class="number">0</span>, p[i] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">int</span> k = top;</span><br><span class="line">        <span class="keyword">while</span>(k &gt; <span class="number">0</span> &amp;&amp; a[stk[k<span class="number">-1</span>]] &lt; a[i]) --k;</span><br><span class="line">        <span class="keyword">if</span>(k) r[stk[k<span class="number">-1</span>]] = i;</span><br><span class="line">        <span class="keyword">if</span>(k &lt; top) l[i] = stk[k];</span><br><span class="line">        stk[k++] = i;</span><br><span class="line">        top = k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;  i &lt;= n; ++i) &#123;</span><br><span class="line">        p[l[i]] = p[r[i]] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> rt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span>(p[i] == <span class="number">0</span>) rt = i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4><span id="解析表达式">解析表达式</span></h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">delim</span> <span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> c == <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_op</span> <span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> c==<span class="string">&#x27;+&#x27;</span> || c==<span class="string">&#x27;-&#x27;</span> || c==<span class="string">&#x27;*&#x27;</span> || c==<span class="string">&#x27;/&#x27;</span> || c==<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">priority</span> <span class="params">(<span class="keyword">char</span> op)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">		op == <span class="string">&#x27;+&#x27;</span> || op == <span class="string">&#x27;-&#x27;</span> ? <span class="number">1</span> :</span><br><span class="line">		op == <span class="string">&#x27;*&#x27;</span> || op == <span class="string">&#x27;/&#x27;</span> || op == <span class="string">&#x27;%&#x27;</span> ? <span class="number">2</span> :</span><br><span class="line">		<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process_op</span> <span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp; st, <span class="keyword">char</span> op)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> r = st.back();  st.pop_back();</span><br><span class="line">	<span class="keyword">int</span> l = st.back();  st.pop_back();</span><br><span class="line">	<span class="keyword">switch</span> (op) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:  st.push_back (l + r);  <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:  st.push_back (l - r);  <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:  st.push_back (l * r);  <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:  st.push_back (l / r);  <span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;%&#x27;</span>:  st.push_back (l % r);  <span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span> <span class="params">(<span class="built_in">string</span> &amp; s)</span> </span>&#123;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; st;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt; op;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>; i&lt;s.length(); ++i)</span><br><span class="line">		<span class="keyword">if</span> (!delim (s[i]))</span><br><span class="line">			<span class="keyword">if</span> (s[i] == <span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">				op.push_back (<span class="string">&#x27;(&#x27;</span>);</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (s[i] == <span class="string">&#x27;)&#x27;</span>) &#123;</span><br><span class="line">				<span class="keyword">while</span> (op.back() != <span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">					process_op (st, op.back()),  op.pop_back();</span><br><span class="line">				op.pop_back();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (is_op (s[i])) &#123;</span><br><span class="line">				<span class="keyword">char</span> curop = s[i];</span><br><span class="line">				<span class="keyword">while</span> (!op.empty() &amp;&amp; priority(op.back()) &gt;= priority(s[i]))</span><br><span class="line">					process_op (st, op.back()),  op.pop_back();</span><br><span class="line">				op.push_back (curop);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="built_in">string</span> operand;</span><br><span class="line">				<span class="keyword">while</span> (i &lt; s.length() &amp;&amp; <span class="built_in">isalnum</span> (s[i])))</span><br><span class="line">					operand += s[i++];</span><br><span class="line">				--i;</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">isdigit</span> (operand[<span class="number">0</span>]))</span><br><span class="line">					st.push_back (atoi (operand.c_str()));</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					st.push_back (get_variable_val (operand));</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="keyword">while</span> (!op.empty())</span><br><span class="line">		process_op (st, op.back()),  op.pop_back();</span><br><span class="line">	<span class="keyword">return</span> st.back();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>含一元操作码</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">delim</span> <span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> c == <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_op</span> <span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> c==<span class="string">&#x27;+&#x27;</span> || c==<span class="string">&#x27;-&#x27;</span> || c==<span class="string">&#x27;*&#x27;</span> || c==<span class="string">&#x27;/&#x27;</span> || c==<span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">priority</span> <span class="params">(<span class="keyword">char</span> op)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (op &lt; <span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="number">4</span>; <span class="comment">// op == -&#x27;+&#x27; || op == -&#x27;-&#x27;</span></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">		op == <span class="string">&#x27;+&#x27;</span> || op == <span class="string">&#x27;-&#x27;</span> ? <span class="number">1</span> :</span><br><span class="line">		op == <span class="string">&#x27;*&#x27;</span> || op == <span class="string">&#x27;/&#x27;</span> || op == <span class="string">&#x27;%&#x27;</span> ? <span class="number">2</span> :</span><br><span class="line">		<span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">process_op</span> <span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp; st, <span class="keyword">char</span> op)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (op &lt; <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">int</span> l = st.back();  st.pop_back();</span><br><span class="line">		<span class="keyword">switch</span> (-op) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:  st.push_back (l);  <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:  st.push_back (-l);  <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">int</span> r = st.back();  st.pop_back();</span><br><span class="line">		<span class="keyword">int</span> l = st.back();  st.pop_back();</span><br><span class="line">		<span class="keyword">switch</span> (op) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:  st.push_back (l + r);  <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:  st.push_back (l - r);  <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:  st.push_back (l * r);  <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:  st.push_back (l / r);  <span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">&#x27;%&#x27;</span>:  st.push_back (l % r);  <span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">calc</span> <span class="params">(<span class="built_in">string</span> &amp; s)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> may_unary = <span class="literal">true</span>;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; st;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt; op;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">size_t</span> i=<span class="number">0</span>; i&lt;s.length(); ++i)</span><br><span class="line">		<span class="keyword">if</span> (!delim (s[i]))</span><br><span class="line">			<span class="keyword">if</span> (s[i] == <span class="string">&#x27;(&#x27;</span>) &#123;</span><br><span class="line">				op.push_back (<span class="string">&#x27;(&#x27;</span>);</span><br><span class="line">				may_unary = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (s[i] == <span class="string">&#x27;)&#x27;</span>) &#123;</span><br><span class="line">				<span class="keyword">while</span> (op.back() != <span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">					process_op (st, op.back()),  op.pop_back();</span><br><span class="line">				op.pop_back();</span><br><span class="line">				may_unary = <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> <span class="keyword">if</span> (is_op (s[i])) &#123;</span><br><span class="line">				<span class="keyword">char</span> curop = s[i];</span><br><span class="line">				<span class="keyword">if</span> (may_unary &amp;&amp; isunary (curop))  curop = -curop;</span><br><span class="line">				<span class="keyword">while</span> (!op.empty() &amp;&amp; (</span><br><span class="line">					curop &gt;= <span class="number">0</span> &amp;&amp; priority(op.back()) &gt;= priority(curop)</span><br><span class="line">					|| curop &lt; <span class="number">0</span> &amp;&amp; priority(op.back()) &gt; priority(curop))</span><br><span class="line">					)</span><br><span class="line">					process_op (st, op.back()),  op.pop_back();</span><br><span class="line">				op.push_back (curop);</span><br><span class="line">				may_unary = <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="built_in">string</span> operand;</span><br><span class="line">				<span class="keyword">while</span> (i &lt; s.length() &amp;&amp; <span class="built_in">isalnum</span> (s[i])))</span><br><span class="line">					operand += s[i++];</span><br><span class="line">				--i;</span><br><span class="line">				<span class="keyword">if</span> (<span class="built_in">isdigit</span> (operand[<span class="number">0</span>]))</span><br><span class="line">					st.push_back (atoi (operand.c_str()));</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">					st.push_back (get_variable_val (operand));</span><br><span class="line">				may_unary = <span class="literal">false</span>;</span><br><span class="line">			&#125;</span><br><span class="line">	<span class="keyword">while</span> (!op.empty())</span><br><span class="line">		process_op (st, op.back()),  op.pop_back();</span><br><span class="line">	<span class="keyword">return</span> st.back();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//值得注意的是，在最简单的情况下，例如，当一元操作只被允许+和- ，</span></span><br><span class="line"><span class="comment">//右结合的戏剧没有作用，因此，在这种情况下，在方案无并发症无法进入。即 周期：</span></span><br><span class="line"></span><br><span class="line">				<span class="keyword">while</span> (!op.empty() &amp;&amp; (</span><br><span class="line">					curop &gt;= <span class="number">0</span> &amp;&amp; priority(op.back()) &gt;= priority(curop)</span><br><span class="line">					|| curop &lt; <span class="number">0</span> &amp;&amp; priority(op.back()) &gt; priority(curop))</span><br><span class="line">					)</span><br><span class="line">					process_op (st, op.back()),  op.pop_back();</span><br><span class="line"></span><br><span class="line"><span class="comment">//可以替换为：</span></span><br><span class="line"></span><br><span class="line">				<span class="keyword">while</span> (!op.empty() &amp;&amp; priority(op.back()) &gt;= priority(curop))</span><br><span class="line">					process_op (st, op.back()),  op.pop_back();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">简介</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="//github.com/luozui">项目</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">数学</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.1.</span> <span class="toc-text">高斯消元 O(n^3)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.2.</span> <span class="toc-text">等价矩阵 O(n^3)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.3.</span> <span class="toc-text">行列式的值 O(n^3)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.4.</span> <span class="toc-text">离散数对</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.5.</span> <span class="toc-text">格雷码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.6.</span> <span class="toc-text">求阶乘 $O(p \log_p n).$</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.7.</span> <span class="toc-text">原根</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.8.</span> <span class="toc-text">卡特兰数应用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.9.</span> <span class="toc-text">康托展开（求任意排列的排名）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.0.9.1.</span> <span class="toc-text">什么是排列的排名？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.0.9.2.</span> <span class="toc-text">时间复杂度？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.0.9.3.</span> <span class="toc-text">怎么实现？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.0.9.4.</span> <span class="toc-text">举个栗子</span></a></li><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.0.9.5.</span> <span class="toc-text">逆康托展开</span></a></li><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">1.0.9.6.</span> <span class="toc-text">引用上面展开的例子</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.10.</span> <span class="toc-text">约瑟夫</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.11.</span> <span class="toc-text">Stirling 数（子集划分）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.0.12.</span> <span class="toc-text">整数拆分</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">博弈</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">2.0.1.</span> <span class="toc-text">任意图表上的博弈</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">2.0.2.</span> <span class="toc-text">FFT</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text">计算几何</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">3.0.1.</span> <span class="toc-text">O(N) 求简单多边形面积</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">3.0.2.</span> <span class="toc-text">凸多边形内接圆</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">3.0.3.</span> <span class="toc-text">通过“缩小边”的方法在凸多边形中找到内切圆 O（n  log n）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">3.0.4.</span> <span class="toc-text">找到三角形联合的区域。垂直分解法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link"><span class="toc-number">3.0.4.1.</span> <span class="toc-text">决定</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">3.0.5.</span> <span class="toc-text">半平面交</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">4.</span> <span class="toc-text">数据结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">4.0.1.</span> <span class="toc-text">笛卡尔树</span></a></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">4.0.2.</span> <span class="toc-text">解析表达式</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&text=竞赛模板整理"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&title=竞赛模板整理"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&is_video=false&description=竞赛模板整理"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=竞赛模板整理&body=Check out this article: https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&title=竞赛模板整理"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&title=竞赛模板整理"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&title=竞赛模板整理"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&title=竞赛模板整理"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://www.lzphi.cn/2018/10/16/%E6%A8%A1%E6%9D%BF%E6%95%B4%E7%90%86/&name=竞赛模板整理&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2020 LuoZui
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">首页</a></li>
         
          <li><a href="/about/">简介</a></li>
         
          <li><a href="/archives/">归档</a></li>
         
          <li><a target="_blank" rel="noopener" href="//github.com/luozui">项目</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</body>
</html>
<!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


<!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->





